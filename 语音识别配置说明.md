# 语音识别功能配置说明

## 功能概述

拼音学习小程序支持语音识别功能，可以识别用户朗读的拼音并判断是否正确。

## 当前状态

- ✅ 录音功能已实现（使用微信小程序 RecorderManager）
- ✅ 语音识别框架已搭建
- ⚠️ 需要配置真实的语音识别服务

## 配置方案

### 方案1：使用腾讯云语音识别（推荐）

1. **开通腾讯云服务**
   - 访问 [腾讯云控制台](https://console.cloud.tencent.com/)
   - 开通"语音识别"服务
   - 获取 SecretId 和 SecretKey

2. **配置云函数**
   - 打开 `cloud/speechRecognition/index.js`
   - 安装腾讯云SDK：
     ```bash
     cd cloud/speechRecognition
     npm install tencentcloud-sdk-nodejs
     ```
   - 修改代码，取消注释腾讯云相关代码
   - 配置 SecretId 和 SecretKey（建议使用环境变量）

3. **部署云函数**
   - 在微信开发者工具中右键 `cloud/speechRecognition` 文件夹
   - 选择"上传并部署：云端安装依赖"
   - 等待部署完成

### 方案2：使用百度语音识别

1. **开通百度AI服务**
   - 访问 [百度AI开放平台](https://ai.baidu.com/)
   - 创建应用，获取 API Key 和 Secret Key

2. **配置云函数**
   - 在云函数中安装百度SDK：
     ```bash
     cd cloud/speechRecognition
     npm install baidu-aip-sdk
     ```
   - 修改 `index.js`，添加百度语音识别代码

3. **部署云函数**

### 方案3：使用讯飞语音识别

1. **开通讯飞服务**
   - 访问 [讯飞开放平台](https://www.xfyun.cn/)
   - 创建应用，获取 AppID、API Key、API Secret

2. **配置云函数**
   - 安装讯飞SDK或使用HTTP API
   - 修改 `index.js`，添加讯飞语音识别代码

3. **部署云函数**

## 当前降级方案

如果未配置语音识别服务，小程序会使用**模拟识别**作为降级方案：
- 录音功能正常
- 识别结果会模拟为"读对了"（用于测试界面效果）
- 会提示用户配置真实的语音识别服务

## 测试步骤

1. **测试录音功能**
   - 点击"点击开始录音"按钮
   - 朗读显示的拼音
   - 再次点击按钮停止录音
   - 检查是否显示"正在识别..."

2. **测试识别功能**
   - 如果已配置云函数，会调用真实的语音识别服务
   - 如果未配置，会使用模拟识别（会提示）

3. **测试成功效果**
   - 识别正确后，会显示成功动画
   - 2秒后自动生成新的拼音

## 注意事项

1. **权限要求**
   - 需要用户授权麦克风权限
   - 首次使用会弹出授权提示

2. **录音格式**
   - 当前使用 MP3 格式
   - 采样率：16000Hz
   - 单声道

3. **识别准确度**
   - 语音识别准确度受多种因素影响：
     - 环境噪音
     - 发音清晰度
     - 语速
   - 建议在安静环境下使用

4. **拼音匹配**
   - 当前使用简单的字符串匹配
   - 可以优化为更智能的拼音匹配算法
   - 支持容错（如声调差异）

## 优化建议

1. **拼音匹配优化**
   - 支持忽略声调差异
   - 支持多音字识别
   - 支持模糊匹配

2. **用户体验优化**
   - 添加发音提示音
   - 优化成功动画效果
   - 添加错误提示和重试功能

3. **功能扩展**
   - 添加学习记录
   - 添加难度等级
   - 添加学习统计

## 常见问题

**Q: 为什么识别总是失败？**
A: 请检查：
1. 是否已配置云函数
2. 云函数是否部署成功
3. API密钥是否正确
4. 网络连接是否正常

**Q: 可以使用免费的语音识别服务吗？**
A: 可以，但需要注意：
- 免费服务通常有调用次数限制
- 准确度可能不如付费服务
- 建议使用腾讯云或百度的免费额度

**Q: 如何提高识别准确度？**
A: 
1. 在安静环境下使用
2. 清晰、标准地发音
3. 适当调整录音时长
4. 使用高质量的语音识别服务

## 技术支持

如有问题，请参考：
- [微信小程序录音API文档](https://developers.weixin.qq.com/miniprogram/dev/api/media/recorder/RecorderManager.html)
- [腾讯云语音识别文档](https://cloud.tencent.com/document/product/1093)
- [百度语音识别文档](https://ai.baidu.com/ai-doc/SPEECH/Vk38lxily)
